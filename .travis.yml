branches:
  only:
  - travis_release_build
  - master
  - release
  - "/^v\\d+\\.\\d+(\\.\\d+)?(-\\S*)?$/"
matrix:
  include:
  - language: android
    sudo: required
    jdk: oraclejdk8
    before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -rf $HOME/.gradle/caches/*/plugin-resolution/
    cache:
      directories:
      - "$HOME/.gradle"
      - "$HOME/.android"
      - ".gradle"
    env:
      - RELEASE_BUILD=true
    android:
      components:
      - platform-tools
      - android-28
      - build-tools-28.0.3
      - extra-google-m2repository
      - extra-android-m2repository
      - tools
      licenses:
      - android-sdk-preview-license-.+
      - android-sdk-license-.+
      - google-gdk-license-.+
    before_install:
    - openssl aes-256-cbc -K $encrypted_1701aaafcc71_key -iv $encrypted_1701aaafcc71_iv -in .travis/android/release.zip.enc -out release.zip -d
    - "./.travis/android/before_install.bash"
    script: ".travis/android/run.bash"
  - language: objective-c
    os: osx
    osx_image: xcode10.1
    xcode_workspace: frontend/ios/DroidKaigi\ 2019.xcworkspace
    cache:
    - directories:
      - ios/frontend/vendor/bundle
      - ios/frontend/Pods
      - "$HOME/.gradle"
      - "$HOME/.android"
      - ".gradle"
      - "$ANDROID_HOME"
    env:
    - ANDROID_HOME="$HOME/android-sdk"
    before_install:
    - "./.travis/ios/before_install.bash"
    script: ".travis/ios/run.bash"
env:
  global:
  - secure: Ch+CmzyuOzXNmmlII9lacT8J4WjQapV9ft/35qn93l4TMBZENlcz5Z32pN2FuLCioSu4YhhR/50uv3JIndEVp/braTF3jIZIxt16rY1plDfvRNM9CCTfMcyBw5iujkYLnm7lsN0Ly8hEnEJhMJ1OIHC1x9iaXpf1Nkz6eMfA1FnEZWMtyOfVSIrm+2R4b8iqnUdig7zbbpSCdIdLdtGBglOtmQqY+pXu4AnU95iLFCWxUQUaLLtZiWpPzA9DUEtERmTuEX7hBgOVy/r0Eo4NiDg/ktZvosasbx+vqly1ScN8/M78AIolTVrm6mkTA+/CNgQKgoTHzC3nJrR+TKP/gtIQz3P1VNmy8e2OUzfxAhhx5myEtp2++qYfeKNDSPFTZMzPJhszi8c3E7L9hjDMOO/WAX0zs5g8wK2ff9Tqk//ZMi72mp8Z3lTIcHWdg1wgBqeQIrJAyMG2yWilyRf7Xx8rTaSijUqCLwJJnJjbhwd6Vdn7D/woaoUlfzRBosPFkpF3WZcTA/Ame1qRaRdp4/I6ikStIPmB8VHKW8xhYGwvU5YICpNRKXLJ3YK/HXqQfAhiw+Cxw9BMo0GpIp129lzVBoJluEaONn28P4BpQBS8Xdom0Yy0SEOkxRD9bVZy8MBQtLVsSaGSgBPTp5sd+sKOjSxynG0YZUCf75JRN6I=
